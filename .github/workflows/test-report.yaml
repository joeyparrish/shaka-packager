# Copyright 2023 Google LLC
#
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file or at
# https://developers.google.com/open-source/licenses/bsd

name: Test Report

# Parses test results in junit format and generates a report on a PR.
#
# Runs when a build workflow is completed.
on:
  workflow_run:
    workflows: [Build]
    types: [completed]

permissions:
  checks: write

jobs:
  checks:
    runs-on: ubuntu-latest
    steps:
      - name: Download Test Report
        uses: actions/download-artifact@v3
        with:
          name: junit-reports
          path: junit-reports

      - name: Publish Test Report
        uses: mikepenz/action-junit-report@150e2f992e4fad1379da2056d1d1c279f520e058
        with:
          commit: ${{ github.event.workflow_run.head_sha }}
          report_paths: 'junit-reports/*/TEST-*.xml'
